{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path='../combo-box/combo-box-model.d.ts'/>\nimport { Property, EventHandler, isNullOrUndefined, detach } from '@syncfusion/ej2-base';\nimport { Event, Complex } from '@syncfusion/ej2-base';\nimport { removeClass, NotifyPropertyChanges } from '@syncfusion/ej2-base';\nimport { dropDownListClasses } from '../drop-down-list/drop-down-list';\nimport { ComboBox } from '../combo-box/combo-box';\nimport { highlightSearch, revertHighlightSearch } from '../common/highlight-search';\nimport { Search } from '../common/incremental-search';\nimport { FieldSettings } from '../drop-down-base/drop-down-base';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { DataManager, Predicate, Query } from '@syncfusion/ej2-data';\ndropDownListClasses.root = 'e-autocomplete';\ndropDownListClasses.icon = 'e-input-group-icon e-ddl-icon e-search-icon';\n/**\n * The AutoComplete component provides the matched suggestion list when type into the input,\n * from which the user can select one.\n * ```html\n * <input id=\"list\" type=\"text\"/>\n * ```\n * ```typescript\n *   let atcObj:AutoComplete = new AutoComplete();\n *   atcObj.appendTo(\"#list\");\n * ```\n */\nvar AutoComplete = /** @class */function (_super) {\n  __extends(AutoComplete, _super);\n  /**\n   * * Constructor for creating the widget\n   *\n   * @param {AutoCompleteModel} options - Specifies the AutoComplete model.\n   * @param {string | HTMLElement} element - Specifies the element to render as component.\n   * @private\n   */\n  function AutoComplete(options, element) {\n    var _this_1 = _super.call(this, options, element) || this;\n    _this_1.isFiltered = false;\n    _this_1.searchList = false;\n    return _this_1;\n  }\n  /**\n   * Initialize the event handler\n   *\n   * @private\n   * @returns {void}\n   */\n  AutoComplete.prototype.preRender = function () {\n    _super.prototype.preRender.call(this);\n  };\n  AutoComplete.prototype.getLocaleName = function () {\n    return 'auto-complete';\n  };\n  AutoComplete.prototype.getNgDirective = function () {\n    return 'EJS-AUTOCOMPLETE';\n  };\n  AutoComplete.prototype.getQuery = function (query) {\n    var filterQuery = query ? query.clone() : this.query ? this.query.clone() : new Query();\n    var filterType = this.queryString === '' && !isNullOrUndefined(this.value) ? 'equal' : this.filterType;\n    var queryString = this.queryString === '' && !isNullOrUndefined(this.value) ? this.value : this.queryString;\n    if (this.isFiltered) {\n      return filterQuery;\n    }\n    if (this.queryString !== null && this.queryString !== '') {\n      var dataType = this.typeOfData(this.dataSource).typeof;\n      if (!(this.dataSource instanceof DataManager) && dataType === 'string' || dataType === 'number') {\n        filterQuery.where('', filterType, queryString, this.ignoreCase, this.ignoreAccent);\n      } else {\n        var mapping = !isNullOrUndefined(this.fields.value) ? this.fields.value : '';\n        filterQuery.where(mapping, filterType, queryString, this.ignoreCase, this.ignoreAccent);\n      }\n    }\n    if (!isNullOrUndefined(this.suggestionCount)) {\n      // Since defualt value of suggestioncount is 20, checked the condition\n      if (this.suggestionCount !== 20) {\n        for (var queryElements = 0; queryElements < filterQuery.queries.length; queryElements++) {\n          if (filterQuery.queries[queryElements].fn === 'onTake') {\n            filterQuery.queries.splice(queryElements, 1);\n          }\n        }\n      }\n      filterQuery.take(this.suggestionCount);\n    }\n    return filterQuery;\n  };\n  AutoComplete.prototype.searchLists = function (e) {\n    var _this_1 = this;\n    this.isTyped = true;\n    this.isDataFetched = this.isSelectCustom = false;\n    if (isNullOrUndefined(this.list)) {\n      _super.prototype.renderList.call(this, e, true);\n    }\n    this.queryString = this.filterInput.value;\n    if (e.type !== 'mousedown' && (e.keyCode === 40 || e.keyCode === 38)) {\n      this.queryString = this.queryString === '' ? null : this.queryString;\n      this.beforePopupOpen = true;\n      this.resetList(this.dataSource, this.fields, null, e);\n      return;\n    }\n    this.isSelected = false;\n    this.activeIndex = null;\n    var eventArgs = {\n      preventDefaultAction: false,\n      text: this.filterInput.value,\n      updateData: function updateData(dataSource, query, fields) {\n        if (eventArgs.cancel) {\n          return;\n        }\n        _this_1.isFiltered = true;\n        _this_1.filterAction(dataSource, query, fields);\n      },\n      cancel: false\n    };\n    this.trigger('filtering', eventArgs, function (eventArgs) {\n      if (!eventArgs.cancel && !_this_1.isFiltered && !eventArgs.preventDefaultAction) {\n        _this_1.searchList = true;\n        _this_1.filterAction(_this_1.dataSource, null, _this_1.fields, e);\n      }\n    });\n  };\n  /**\n   * To filter the data from given data source by using query\n   *\n   * @param {Object[] | DataManager } dataSource - Set the data source to filter.\n   * @param {Query} query - Specify the query to filter the data.\n   * @param {FieldSettingsModel} fields - Specify the fields to map the column in the data table.\n   * @returns {void}\n    */\n  AutoComplete.prototype.filter = function (dataSource, query, fields) {\n    this.isFiltered = true;\n    this.filterAction(dataSource, query, fields);\n  };\n  AutoComplete.prototype.filterAction = function (dataSource, query, fields, e) {\n    this.beforePopupOpen = true;\n    if (this.queryString !== '' && this.queryString.length >= this.minLength) {\n      this.resetList(dataSource, fields, query, e);\n    } else {\n      this.hidePopup(e);\n      this.beforePopupOpen = false;\n    }\n    this.renderReactTemplates();\n  };\n  AutoComplete.prototype.clearAll = function (e, property) {\n    if (isNullOrUndefined(property) || !isNullOrUndefined(property) && isNullOrUndefined(property.dataSource)) {\n      _super.prototype.clearAll.call(this, e);\n    }\n    if (this.beforePopupOpen) {\n      this.hidePopup();\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  AutoComplete.prototype.onActionComplete = function (ulElement, list, e, isUpdated) {\n    this.fixedHeaderElement = null;\n    _super.prototype.onActionComplete.call(this, ulElement, list, e);\n    var item = this.list.querySelector('.' + dropDownListClasses.li);\n    if (!isNullOrUndefined(item)) {\n      removeClass([item], dropDownListClasses.focus);\n    }\n    this.postBackAction();\n  };\n  AutoComplete.prototype.postBackAction = function () {\n    if (this.autofill && !isNullOrUndefined(this.liCollections[0]) && this.searchList) {\n      var items = [this.liCollections[0]];\n      var dataSource = this.listData;\n      var type = this.typeOfData(dataSource).typeof;\n      var searchItem = Search(this.inputElement.value, items, 'StartsWith', this.ignoreCase, dataSource, this.fields, type);\n      this.searchList = false;\n      if (!isNullOrUndefined(searchItem.item)) {\n        _super.prototype.setAutoFill.call(this, this.liCollections[0], true);\n      }\n    }\n  };\n  AutoComplete.prototype.setSelection = function (li, e) {\n    if (!this.isValidLI(li)) {\n      this.selectedLI = li;\n      return;\n    }\n    if (!isNullOrUndefined(e) && e.type === 'keydown' && e.action !== 'enter' && e.action !== 'tab' && this.isValidLI(li)) {\n      var value = this.getFormattedValue(li.getAttribute('data-value'));\n      this.activeIndex = this.getIndexByValue(value);\n      this.setHoverList(li);\n      this.selectedLI = li;\n      this.setScrollPosition(e);\n      if (this.autofill && this.isPopupOpen) {\n        this.preventAutoFill = false;\n        var isKeyNavigate = e && e.action === 'down' || e.action === 'up' || e.action === 'home' || e.action === 'end' || e.action === 'pageUp' || e.action === 'pageDown';\n        _super.prototype.setAutoFill.call(this, li, isKeyNavigate);\n      }\n    } else {\n      _super.prototype.setSelection.call(this, li, e);\n    }\n  };\n  AutoComplete.prototype.listOption = function (dataSource, fieldsSettings) {\n    var _this_1 = this;\n    var fields = _super.prototype.listOption.call(this, dataSource, fieldsSettings);\n    if (isNullOrUndefined(fields.itemCreated)) {\n      fields.itemCreated = function (e) {\n        if (_this_1.highlight) {\n          if (_this_1.element.tagName === _this_1.getNgDirective() && _this_1.itemTemplate) {\n            setTimeout(function () {\n              highlightSearch(e.item, _this_1.queryString, _this_1.ignoreCase, _this_1.filterType);\n            }, 0);\n          } else {\n            highlightSearch(e.item, _this_1.queryString, _this_1.ignoreCase, _this_1.filterType);\n          }\n        }\n      };\n    } else {\n      var itemCreated_1 = fields.itemCreated;\n      fields.itemCreated = function (e) {\n        if (_this_1.highlight) {\n          highlightSearch(e.item, _this_1.queryString, _this_1.ignoreCase, _this_1.filterType);\n        }\n        itemCreated_1.apply(_this_1, [e]);\n      };\n    }\n    return fields;\n  };\n  AutoComplete.prototype.isFiltering = function () {\n    return true;\n  };\n  AutoComplete.prototype.renderPopup = function (e) {\n    this.list.scrollTop = 0;\n    _super.prototype.renderPopup.call(this, e);\n  };\n  AutoComplete.prototype.isEditTextBox = function () {\n    return true && this.inputElement.value.trim() !== '';\n  };\n  AutoComplete.prototype.isPopupButton = function () {\n    return this.showPopupButton;\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  AutoComplete.prototype.isSelectFocusItem = function (element) {\n    return false;\n  };\n  AutoComplete.prototype.setInputValue = function (newProp, oldProp) {\n    var oldValue = oldProp && oldProp.text ? oldProp.text : oldProp ? oldProp.value : oldProp;\n    var value = newProp && newProp.text ? newProp.text : newProp && newProp.value ? newProp.value : this.value;\n    if (value && this.typedString === '' && !this.allowCustom && !(this.dataSource instanceof DataManager)) {\n      var checkFields_1_1 = this.typeOfData(this.dataSource).typeof === 'string' ? '' : this.fields.value;\n      var listLength_1 = this.getItems().length;\n      var query = new Query();\n      var _this_2 = this;\n      new DataManager(this.dataSource).executeQuery(query.where(new Predicate(checkFields_1_1, 'equal', value))).then(function (e) {\n        if (e.result.length > 0) {\n          _this_2.value = checkFields_1_1 !== '' ? e.result[0][_this_2.fields.value].toString() : e.result[0].toString();\n          _this_2.addItem(e.result, listLength_1);\n          _this_2.updateValues();\n        } else {\n          newProp && newProp.text ? _this_2.setOldText(oldValue) : newProp && newProp.value ? _this_2.setOldValue(oldValue) : _this_2.updateValues();\n        }\n      });\n    } else if (newProp) {\n      newProp.text ? this.setOldText(oldValue) : this.setOldValue(oldValue);\n    }\n  };\n  /**\n   * Search the entered text and show it in the suggestion list if available.\n   *\n   * @returns {void}\n    */\n  AutoComplete.prototype.showPopup = function (e) {\n    if (!this.enabled) {\n      return;\n    }\n    if (this.beforePopupOpen) {\n      this.refreshPopup();\n      return;\n    }\n    this.beforePopupOpen = true;\n    this.preventAutoFill = true;\n    if (isNullOrUndefined(this.list)) {\n      this.renderList(e);\n    } else {\n      this.resetList(this.dataSource, this.fields, null, e);\n    }\n  };\n  /**\n   * Hides the popup if it is in open state.\n   *\n   * @returns {void}\n   */\n  AutoComplete.prototype.hidePopup = function (e) {\n    _super.prototype.hidePopup.call(this, e);\n    this.activeIndex = null;\n  };\n  /**\n   * Dynamically change the value of properties.\n   *\n   * @param {AutoCompleteModel} newProp - Returns the dynamic property value of the component.\n   * @param {AutoCompleteModel} oldProp - Returns the previous property value of the component.\n   * @private\n   * @returns {void}\n   */\n  AutoComplete.prototype.onPropertyChanged = function (newProp, oldProp) {\n    if (this.getModuleName() === 'autocomplete') {\n      this.setUpdateInitial(['fields', 'query', 'dataSource'], newProp);\n    }\n    for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      switch (prop) {\n        case 'showPopupButton':\n          if (this.showPopupButton) {\n            var button = Input.appendSpan(dropDownListClasses.icon, this.inputWrapper.container, this.createElement);\n            this.inputWrapper.buttons[0] = button;\n            Input.calculateWidth(this.inputElement, this.inputWrapper.container);\n            if (!isNullOrUndefined(this.inputWrapper.buttons[0]) && !isNullOrUndefined(this.inputWrapper.container.getElementsByClassName('e-float-text-overflow')[0]) && this.floatLabelType !== 'Never') {\n              this.inputWrapper.container.getElementsByClassName('e-float-text-overflow')[0].classList.add('e-icon');\n            }\n            if (this.inputWrapper && this.inputWrapper.buttons && this.inputWrapper.buttons[0]) {\n              EventHandler.add(this.inputWrapper.buttons[0], 'click', this.dropDownClick, this);\n            }\n          } else {\n            detach(this.inputWrapper.buttons[0]);\n            this.inputWrapper.buttons[0] = null;\n          }\n          break;\n        default:\n          {\n            // eslint-disable-next-line max-len\n            var atcProps = this.getPropObject(prop, newProp, oldProp);\n            _super.prototype.onPropertyChanged.call(this, atcProps.newProperty, atcProps.oldProperty);\n            break;\n          }\n      }\n    }\n  };\n  AutoComplete.prototype.renderHightSearch = function () {\n    if (this.highlight) {\n      for (var i = 0; i < this.liCollections.length; i++) {\n        var isHighlight = this.ulElement.querySelector('.e-active');\n        if (!isHighlight) {\n          revertHighlightSearch(this.liCollections[i]);\n          highlightSearch(this.liCollections[i], this.queryString, this.ignoreCase, this.filterType);\n        }\n      }\n    }\n  };\n  /**\n   * Return the module name of this component.\n   *\n   * @private\n   * @returns {string} Return the module name of this component.\n   */\n  AutoComplete.prototype.getModuleName = function () {\n    return 'autocomplete';\n  };\n  /**\n   * To initialize the control rendering\n   *\n   * @private\n   * @returns {void}\n   */\n  AutoComplete.prototype.render = function () {\n    _super.prototype.render.call(this);\n  };\n  __decorate([Complex({\n    value: null,\n    iconCss: null,\n    groupBy: null\n  }, FieldSettings)], AutoComplete.prototype, \"fields\", void 0);\n  __decorate([Property(true)], AutoComplete.prototype, \"ignoreCase\", void 0);\n  __decorate([Property(false)], AutoComplete.prototype, \"showPopupButton\", void 0);\n  __decorate([Property(false)], AutoComplete.prototype, \"highlight\", void 0);\n  __decorate([Property(20)], AutoComplete.prototype, \"suggestionCount\", void 0);\n  __decorate([Property({})], AutoComplete.prototype, \"htmlAttributes\", void 0);\n  __decorate([Property(null)], AutoComplete.prototype, \"query\", void 0);\n  __decorate([Property(1)], AutoComplete.prototype, \"minLength\", void 0);\n  __decorate([Property('Contains')], AutoComplete.prototype, \"filterType\", void 0);\n  __decorate([Event()], AutoComplete.prototype, \"filtering\", void 0);\n  __decorate([Property(null)], AutoComplete.prototype, \"index\", void 0);\n  __decorate([Property('Never')], AutoComplete.prototype, \"floatLabelType\", void 0);\n  __decorate([Property(null)], AutoComplete.prototype, \"valueTemplate\", void 0);\n  __decorate([Property(null)], AutoComplete.prototype, \"filterBarPlaceholder\", void 0);\n  __decorate([Property(false)], AutoComplete.prototype, \"allowFiltering\", void 0);\n  __decorate([Property(null)], AutoComplete.prototype, \"text\", void 0);\n  AutoComplete = __decorate([NotifyPropertyChanges], AutoComplete);\n  return AutoComplete;\n}(ComboBox);\nexport { AutoComplete };","map":null,"metadata":{},"sourceType":"module"}